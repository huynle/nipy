<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Neuroimaging in Python &#8212; NIPY Documentation</title>
    
    <link rel="stylesheet" href="../../_static/nipy.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5.0.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="modalities.fmri.hemodynamic_models" href="nipy.modalities.fmri.hemodynamic_models.html" />
    <link rel="prev" title="modalities.fmri.fmristat.outputters" href="nipy.modalities.fmri.fmristat.outputters.html" />
  <meta name="keywords" content="nipy, neuroimaging, python, neuroscience, time
				 series">

  </head>
  <body role="document">
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
 <a href="../../index.html">
  <img src="../../_static/reggie2.png" alt="NIPY logo"  border="0" />
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nipy.modalities.fmri.hemodynamic_models.html" title="modalities.fmri.hemodynamic_models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nipy.modalities.fmri.fmristat.outputters.html" title="modalities.fmri.fmristat.outputters"
             accesskey="P">previous</a> |</li>
  <li><a href="../../index.html">NIPY home</a> |&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >NIPY documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U">API</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

  
<h4> Site Navigation </h4>
  <ul>
    <li><a href="../../documentation.html">Documentation</a></li>
    <li><a href="../../devel/index.html">Development</a></li>
  </ul>

<h4> NIPY Community </h4>
  <ul class="simple">
    <li><a class="reference external"
	href="http://nipy.org/">Community Home</a></li>
    <li><a class="reference external"
	href="http://nipy.org/project-directory">NIPY Projects</a></li>
    <li><a class="reference external"
	href="https://mail.python.org/mailman/listinfo/neuroimaging">Mailing List</a></li>
    <li><a class="reference external"
	href="license.html">License</a></li>
  </ul>

<h4> Github repo </h4>
  <ul class="simple">
    <li><a class="reference external"
	href="http://github.com/nipy/nipy/">Nipy Github</a></li>
  </ul>

  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">modalities.fmri.glm</a><ul>
<li><a class="reference internal" href="#module-modalities-fmri-glm">Module: <code class="docutils literal"><span class="pre">modalities.fmri.glm</span></code></a></li>
<li><a class="reference internal" href="#classes">Classes</a><ul>
<li><a class="reference internal" href="#contrast"><code class="docutils literal"><span class="pre">Contrast</span></code></a></li>
<li><a class="reference internal" href="#fmrilinearmodel"><code class="docutils literal"><span class="pre">FMRILinearModel</span></code></a></li>
<li><a class="reference internal" href="#generallinearmodel"><code class="docutils literal"><span class="pre">GeneralLinearModel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#function">Function</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nipy.modalities.fmri.fmristat.outputters.html"
                        title="previous chapter">modalities.fmri.fmristat.outputters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nipy.modalities.fmri.hemodynamic_models.html"
                        title="next chapter">modalities.fmri.hemodynamic_models</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/api/generated/nipy.modalities.fmri.glm.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>

<div id="searchbox-ml" style="display: none">
  <h3>Search mailing list archive</h3>
  <script type="text/javascript">
    function mlsearch(curobj)
    {
    curobj.q.value="site:http://mail.python.org/pipermail/neuroimaging/ "+curobj.userquery.value
    }
  </script>
  <form action="http://www.google.com/search" method="get" onSubmit="mlsearch(this)">
    <input name="userquery" size="13" type="text" /> <input type="submit" value="Go" />
    <input name="q" type="hidden" />
  </form>
</div>
  
<div id="searchbox-site" style="display: none">
  <h3>Search this site</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="13" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script type="text/javascript">$('#searchbox-ml').show(0);</script>
<script type="text/javascript">$('#searchbox-site').show(0);</script>


        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="modalities-fmri-glm">
<h1>modalities.fmri.glm<a class="headerlink" href="#modalities-fmri-glm" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-modalities-fmri-glm">
<h2>Module: <code class="xref py py-mod docutils literal"><span class="pre">modalities.fmri.glm</span></code><a class="headerlink" href="#module-modalities-fmri-glm" title="Permalink to this headline">¶</a></h2>
<p>Inheritance diagram for <code class="docutils literal"><span class="pre">nipy.modalities.fmri.glm</span></code>:</p>
<img src="../../_images/inheritance-882fd3de5cbe17661a34c7434ee21375f7eb2ea4.png" alt="Inheritance diagram of nipy.modalities.fmri.glm" usemap="#inheritanceb39cb322e4" class="inheritance"/>
<map id="inheritanceb39cb322e4" name="inheritanceb39cb322e4">
<area shape="rect" id="node1" href="#nipy.modalities.fmri.glm.Contrast" target="_top" title="The contrast class handles the estimation of statistical contrasts" alt="" coords="42,107,178,133"/>
<area shape="rect" id="node2" href="#nipy.modalities.fmri.glm.FMRILinearModel" target="_top" title="This class is meant to handle GLMs from a higher&#45;level perspective" alt="" coords="15,56,205,82"/>
<area shape="rect" id="node3" href="#nipy.modalities.fmri.glm.GeneralLinearModel" target="_top" title="This class handles the so&#45;called on General Linear Model" alt="" coords="5,5,215,32"/>
</map>
<span class="target" id="module-nipy.modalities.fmri.glm"></span><p>This module presents an interface to use the glm implemented in
nipy.algorithms.statistics.models.regression.

It contains the GLM and contrast classes that are meant to be the main objects
of fMRI data analyses.

It is important to note that the GLM is meant as a one-session General Linear
Model. But inference can be performed on multiple sessions by computing fixed
effects on contrasts

Examples
&#8212;&#8212;&#8211;

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from nipy.modalities.fmri.glm import GeneralLinearModel
&gt;&gt;&gt; n, p, q = 100, 80, 10
&gt;&gt;&gt; X, Y = np.random.randn(p, q), np.random.randn(p, n)
&gt;&gt;&gt; cval = np.hstack((1, np.zeros(9)))
&gt;&gt;&gt; model = GeneralLinearModel(X)
&gt;&gt;&gt; model.fit(Y)
&gt;&gt;&gt; z_vals = model.contrast(cval).z_score() # z-transformed statistics

Example of fixed effects statistics across two contrasts

&gt;&gt;&gt; <a href="#id1"><span class="problematic" id="id2">cval_</span></a> = cval.copy()
&gt;&gt;&gt; np.random.shuffle(<a href="#id3"><span class="problematic" id="id4">cval_</span></a>)
&gt;&gt;&gt; z_ffx = (model.contrast(cval) + model.contrast(<a href="#id5"><span class="problematic" id="id6">cval_</span></a>)).z_score()</p>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="contrast">
<h3><a class="reference internal" href="#nipy.modalities.fmri.glm.Contrast" title="nipy.modalities.fmri.glm.Contrast"><code class="xref py py-class docutils literal"><span class="pre">Contrast</span></code></a><a class="headerlink" href="#contrast" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.modalities.fmri.glm.Contrast">
<em class="property">class </em><code class="descclassname">nipy.modalities.fmri.glm.</code><code class="descname">Contrast</code><span class="sig-paren">(</span><em>effect</em>, <em>variance</em>, <em>dof=10000000000.0</em>, <em>contrast_type='t'</em>, <em>tiny=1e-50</em>, <em>dofmax=10000000000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.Contrast" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The contrast class handles the estimation of statistical contrasts
on a given model: student (t), Fisher (F), conjunction (tmin-conjunction).
The important feature is that it supports addition,
thus opening the possibility of fixed-effects models.</p>
<p>The current implementation is meant to be simple,
and could be enhanced in the future on the computational side
(high-dimensional F constrasts may lead to memory breakage).</p>
<p class="rubric">Notes</p>
<p>The &#8216;tmin-conjunction&#8217; test is the valid conjunction test discussed in:
Nichols T, Brett M, Andersson J, Wager T, Poline JB. Valid conjunction
inference with the minimum statistic. Neuroimage. 2005 Apr 15;25(3):653-60.
This test gives the p-value of the z-values under the conjunction null,
i.e. the union of the null hypotheses for all terms.</p>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.Contrast.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>effect</em>, <em>variance</em>, <em>dof=10000000000.0</em>, <em>contrast_type='t'</em>, <em>tiny=1e-50</em>, <em>dofmax=10000000000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.Contrast.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>effect: array of shape (contrast_dim, n_voxels)</strong></p>
<blockquote>
<div><p>the effects related to the contrast</p>
</div></blockquote>
<p><strong>variance: array of shape (contrast_dim, contrast_dim, n_voxels)</strong></p>
<blockquote>
<div><p>the associated variance estimate</p>
</div></blockquote>
<p><strong>dof: scalar, the degrees of freedom</strong></p>
<p class="last"><strong>contrast_type: string to be chosen among &#8216;t&#8217; and &#8216;F&#8217;</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nipy.modalities.fmri.glm.Contrast.p_value">
<code class="descname">p_value</code><span class="sig-paren">(</span><em>baseline=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.Contrast.p_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return a parametric estimate of the p-value associated
with the null hypothesis: (H0) &#8216;contrast equals baseline&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>baseline: float, optional</strong></p>
<blockquote class="last">
<div><p>Baseline value for the test statistic</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The value of 0.5 is used where the stat is not defined</p>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.Contrast.stat">
<code class="descname">stat</code><span class="sig-paren">(</span><em>baseline=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.Contrast.stat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the decision statistic associated with the test of the
null hypothesis: (H0) &#8216;contrast equals baseline&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>baseline: float, optional,</strong></p>
<blockquote class="last">
<div><p>Baseline value for the test statistic</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.Contrast.z_score">
<code class="descname">z_score</code><span class="sig-paren">(</span><em>baseline=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.Contrast.z_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return a parametric estimation of the z-score associated
with the null hypothesis: (H0) &#8216;contrast equals baseline&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>baseline: float, optional</strong></p>
<blockquote class="last">
<div><p>Baseline value for the test statistic</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The value of 0 is used where the stat is not defined</p>
</dd></dl>

</div>
<div class="section" id="fmrilinearmodel">
<h3><a class="reference internal" href="#nipy.modalities.fmri.glm.FMRILinearModel" title="nipy.modalities.fmri.glm.FMRILinearModel"><code class="xref py py-class docutils literal"><span class="pre">FMRILinearModel</span></code></a><a class="headerlink" href="#fmrilinearmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.modalities.fmri.glm.FMRILinearModel">
<em class="property">class </em><code class="descclassname">nipy.modalities.fmri.glm.</code><code class="descname">FMRILinearModel</code><span class="sig-paren">(</span><em>fmri_data</em>, <em>design_matrices</em>, <em>mask='compute'</em>, <em>m=0.2</em>, <em>M=0.9</em>, <em>threshold=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.FMRILinearModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class is meant to handle GLMs from a higher-level perspective
i.e. by taking images as input and output</p>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.FMRILinearModel.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>fmri_data</em>, <em>design_matrices</em>, <em>mask='compute'</em>, <em>m=0.2</em>, <em>M=0.9</em>, <em>threshold=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.FMRILinearModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fmri_data</strong> : Image or str or sequence of Images / str</p>
<blockquote>
<div><p>fmri images / paths of the (4D) fmri images</p>
</div></blockquote>
<p><strong>design_matrices</strong> : arrays or str or sequence of arrays / str</p>
<blockquote>
<div><p>design matrix arrays / paths of .npz files</p>
</div></blockquote>
<p><strong>mask</strong> : str or Image or None, optional</p>
<blockquote>
<div><p>string can be &#8216;compute&#8217; or a path to an image
image is an input (assumed binary) mask image(s),
if &#8216;compute&#8217;, the mask is computed
if None, no masking will be applied</p>
</div></blockquote>
<p><strong>m, M, threshold: float, optional</strong></p>
<blockquote class="last">
<div><p>parameters of the masking procedure.  Should be within [0, 1]</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The only computation done here is mask computation (if required)</p>
<p class="rubric">Examples</p>
<p>We need the example data package for this example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nipy.utils</span> <span class="k">import</span> <span class="n">example_data</span>
<span class="kn">from</span> <span class="nn">nipy.modalities.fmri.glm</span> <span class="k">import</span> <span class="n">FMRILinearModel</span>
<span class="n">fmri_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">example_data</span><span class="o">.</span><span class="n">get_filename</span><span class="p">(</span><span class="s1">&#39;fiac&#39;</span><span class="p">,</span> <span class="s1">&#39;fiac0&#39;</span><span class="p">,</span> <span class="n">run</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;run1.nii.gz&#39;</span><span class="p">,</span> <span class="s1">&#39;run2.nii.gz&#39;</span><span class="p">]]</span>
<span class="n">design_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">example_data</span><span class="o">.</span><span class="n">get_filename</span><span class="p">(</span><span class="s1">&#39;fiac&#39;</span><span class="p">,</span> <span class="s1">&#39;fiac0&#39;</span><span class="p">,</span> <span class="n">run</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;run1_design.npz&#39;</span><span class="p">,</span> <span class="s1">&#39;run2_design.npz&#39;</span><span class="p">]]</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">get_filename</span><span class="p">(</span><span class="s1">&#39;fiac&#39;</span><span class="p">,</span> <span class="s1">&#39;fiac0&#39;</span><span class="p">,</span> <span class="s1">&#39;mask.nii.gz&#39;</span><span class="p">)</span>
<span class="n">multi_session_model</span> <span class="o">=</span> <span class="n">FMRILinearModel</span><span class="p">(</span><span class="n">fmri_files</span><span class="p">,</span>
                                      <span class="n">design_files</span><span class="p">,</span>
                                      <span class="n">mask</span><span class="p">)</span>
<span class="n">multi_session_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">z_image</span><span class="p">,</span> <span class="o">=</span> <span class="n">multi_session_model</span><span class="o">.</span><span class="n">contrast</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">13</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># The number of voxels with p &lt; 0.001 given by ...</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">z_image</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">3.09</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="nipy.modalities.fmri.glm.FMRILinearModel.contrast">
<code class="descname">contrast</code><span class="sig-paren">(</span><em>contrasts</em>, <em>con_id=''</em>, <em>contrast_type=None</em>, <em>output_z=True</em>, <em>output_stat=False</em>, <em>output_effects=False</em>, <em>output_variance=False</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.FMRILinearModel.contrast" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Estimation of a contrast as fixed effects on all sessions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>contrasts</strong> : array or list of arrays of shape (n_col) or (n_dim, n_col)</p>
<blockquote>
<div><p>where <code class="docutils literal"><span class="pre">n_col</span></code> is the number of columns of the design matrix,
numerical definition of the contrast (one array per run)</p>
</div></blockquote>
<p><strong>con_id</strong> : str, optional</p>
<blockquote>
<div><p>name of the contrast</p>
</div></blockquote>
<p><strong>contrast_type</strong> : {&#8216;t&#8217;, &#8216;F&#8217;, &#8216;tmin-conjunction&#8217;}, optional</p>
<blockquote>
<div><p>type of the contrast</p>
</div></blockquote>
<p><strong>output_z</strong> : bool, optional</p>
<blockquote>
<div><p>Return or not the corresponding z-stat image</p>
</div></blockquote>
<p><strong>output_stat</strong> : bool, optional</p>
<blockquote>
<div><p>Return or not the base (t/F) stat image</p>
</div></blockquote>
<p><strong>output_effects</strong> : bool, optional</p>
<blockquote>
<div><p>Return or not the corresponding effect image</p>
</div></blockquote>
<p><strong>output_variance</strong> : bool, optional</p>
<blockquote>
<div><p>Return or not the corresponding variance image</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>output_images</strong> : list of nibabel images</p>
<blockquote class="last">
<div><p>The required output images, in the following order:
z image, stat(t/F) image, effects image, variance image</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.FMRILinearModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>do_scaling=True</em>, <em>model='ar1'</em>, <em>steps=100</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.FMRILinearModel.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Load the data, mask the data, scale the data, fit the GLM</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>do_scaling</strong> : bool, optional</p>
<blockquote>
<div><p>if True, the data should be scaled as percent of voxel mean</p>
</div></blockquote>
<p><strong>model</strong> : string, optional,</p>
<blockquote>
<div><p>the kind of glm (&#8216;ols&#8217; or &#8216;ar1&#8217;) you want to fit to the data</p>
</div></blockquote>
<p><strong>steps</strong> : int, optional</p>
<blockquote class="last">
<div><p>in case of an ar1, discretization of the ar1 parameter</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="generallinearmodel">
<h3><a class="reference internal" href="#nipy.modalities.fmri.glm.GeneralLinearModel" title="nipy.modalities.fmri.glm.GeneralLinearModel"><code class="xref py py-class docutils literal"><span class="pre">GeneralLinearModel</span></code></a><a class="headerlink" href="#generallinearmodel" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.modalities.fmri.glm.GeneralLinearModel">
<em class="property">class </em><code class="descclassname">nipy.modalities.fmri.glm.</code><code class="descname">GeneralLinearModel</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.GeneralLinearModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class handles the so-called on General Linear Model</p>
<p>Most of what it does in the fit() and contrast() methods
fit() performs the standard two-step (&#8216;ols&#8217; then &#8216;ar1&#8217;) GLM fitting
contrast() returns a contrast instance, yileding statistics and p-values.
The link between fit() and constrast is done vis the two class members:</p>
<dl class="docutils">
<dt>glm_results</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">dictionary of nipy.algorithms.statistics.models.</span><dd>regression.RegressionResults instances,
describing results of a GLM fit</dd>
<dt>labels</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array of shape(n_voxels),</span><dd>labels that associate each voxel with a results key</dd>
</dl>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.GeneralLinearModel.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.GeneralLinearModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : array of shape (n_time_points, n_regressors)</p>
<blockquote class="last">
<div><p>the design matrix</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nipy.modalities.fmri.glm.GeneralLinearModel.contrast">
<code class="descname">contrast</code><span class="sig-paren">(</span><em>con_val</em>, <em>contrast_type=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.GeneralLinearModel.contrast" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Specify and estimate a linear contrast</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>con_val</strong> : numpy.ndarray of shape (p) or (q, p)</p>
<blockquote>
<div><p>where q = number of contrast vectors and p = number of regressors</p>
</div></blockquote>
<p><strong>contrast_type</strong> : {None, &#8216;t&#8217;, &#8216;F&#8217; or &#8216;tmin-conjunction&#8217;}, optional</p>
<blockquote>
<div><p>type of the contrast.  If None, then defaults to &#8216;t&#8217; for 1D
<cite>con_val</cite> and &#8216;F&#8217; for 2D <cite>con_val</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">con: Contrast instance</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.GeneralLinearModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>Y</em>, <em>model='ols'</em>, <em>steps=100</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.GeneralLinearModel.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>GLM fitting of a dataset using &#8216;ols&#8217; regression or the two-pass</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Y</strong> : array of shape(n_time_points, n_samples)</p>
<blockquote>
<div><p>the fMRI data</p>
</div></blockquote>
<p><strong>model</strong> : {&#8216;ar1&#8217;, &#8216;ols&#8217;}, optional</p>
<blockquote>
<div><p>the temporal variance model. Defaults to &#8216;ols&#8217;</p>
</div></blockquote>
<p><strong>steps</strong> : int, optional</p>
<blockquote class="last">
<div><p>Maximum number of discrete steps for the AR(1) coef histogram</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.GeneralLinearModel.get_beta">
<code class="descname">get_beta</code><span class="sig-paren">(</span><em>column_index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.GeneralLinearModel.get_beta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Accessor for the best linear unbiased estimated of model parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>column_index: int or array-like of int or None, optional</strong></p>
<blockquote>
<div><p>The indexed of the columns to be returned.  if None (default
behaviour), the whole vector is returned</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">beta: array of shape (n_voxels, n_columns)</p>
<blockquote class="last">
<div><p>the beta</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.GeneralLinearModel.get_logL">
<code class="descname">get_logL</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.GeneralLinearModel.get_logL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Accessor for the log-likelihood of the model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">logL: array of shape (n_voxels,)</p>
<blockquote class="last">
<div><p>the sum of square error per voxel</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.modalities.fmri.glm.GeneralLinearModel.get_mse">
<code class="descname">get_mse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.GeneralLinearModel.get_mse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Accessor for the mean squared error of the model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">mse: array of shape (n_voxels)</p>
<blockquote class="last">
<div><p>the sum of square error per voxel</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="function">
<h2>Function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nipy.modalities.fmri.glm.data_scaling">
<code class="descclassname">nipy.modalities.fmri.glm.</code><code class="descname">data_scaling</code><span class="sig-paren">(</span><em>Y</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.glm.data_scaling" title="Permalink to this definition">¶</a></dt>
<dd><p>Scaling of the data to have percent of baseline change columnwise</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Y: array of shape(n_time_points, n_voxels)</strong></p>
<blockquote>
<div><p>the input data</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Y: array of shape (n_time_points, n_voxels),</p>
<blockquote>
<div><p>the data after mean-scaling, de-meaning and multiplication by 100</p>
</div></blockquote>
<p><strong>mean</strong> : array of shape (n_voxels,)</p>
<blockquote class="last">
<div><p>the data mean</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nipy.modalities.fmri.hemodynamic_models.html" title="modalities.fmri.hemodynamic_models"
             >next</a> |</li>
        <li class="right" >
          <a href="nipy.modalities.fmri.fmristat.outputters.html" title="modalities.fmri.fmristat.outputters"
             >previous</a> |</li>
  <li><a href="../../index.html">NIPY home</a> |&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >NIPY documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >API</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2017, Neuroimaging in Python team.
      Last updated on Mar 17, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>