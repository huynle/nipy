<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Neuroimaging in Python &#8212; NIPY Documentation</title>
    
    <link rel="stylesheet" href="../../_static/nipy.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5.0.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="algorithms.registration.histogram_registration" href="nipy.algorithms.registration.histogram_registration.html" />
    <link rel="prev" title="algorithms.registration.chain_transform" href="nipy.algorithms.registration.chain_transform.html" />
  <meta name="keywords" content="nipy, neuroimaging, python, neuroscience, time
				 series">

  </head>
  <body role="document">
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
 <a href="../../index.html">
  <img src="../../_static/reggie2.png" alt="NIPY logo"  border="0" />
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nipy.algorithms.registration.histogram_registration.html" title="algorithms.registration.histogram_registration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nipy.algorithms.registration.chain_transform.html" title="algorithms.registration.chain_transform"
             accesskey="P">previous</a> |</li>
  <li><a href="../../index.html">NIPY home</a> |&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >NIPY documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U">API</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

  
<h4> Site Navigation </h4>
  <ul>
    <li><a href="../../documentation.html">Documentation</a></li>
    <li><a href="../../devel/index.html">Development</a></li>
  </ul>

<h4> NIPY Community </h4>
  <ul class="simple">
    <li><a class="reference external"
	href="http://nipy.org/">Community Home</a></li>
    <li><a class="reference external"
	href="http://nipy.org/project-directory">NIPY Projects</a></li>
    <li><a class="reference external"
	href="https://mail.python.org/mailman/listinfo/neuroimaging">Mailing List</a></li>
    <li><a class="reference external"
	href="license.html">License</a></li>
  </ul>

<h4> Github repo </h4>
  <ul class="simple">
    <li><a class="reference external"
	href="http://github.com/nipy/nipy/">Nipy Github</a></li>
  </ul>

  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">algorithms.registration.groupwise_registration</a><ul>
<li><a class="reference internal" href="#module-algorithms-registration-groupwise-registration">Module: <code class="docutils literal"><span class="pre">algorithms.registration.groupwise_registration</span></code></a></li>
<li><a class="reference internal" href="#classes">Classes</a><ul>
<li><a class="reference internal" href="#fmrirealign4d"><code class="docutils literal"><span class="pre">FmriRealign4d</span></code></a></li>
<li><a class="reference internal" href="#image4d"><code class="docutils literal"><span class="pre">Image4d</span></code></a></li>
<li><a class="reference internal" href="#realign4d"><code class="docutils literal"><span class="pre">Realign4d</span></code></a></li>
<li><a class="reference internal" href="#realign4dalgorithm"><code class="docutils literal"><span class="pre">Realign4dAlgorithm</span></code></a></li>
<li><a class="reference internal" href="#spacerealign"><code class="docutils literal"><span class="pre">SpaceRealign</span></code></a></li>
<li><a class="reference internal" href="#spacetimerealign"><code class="docutils literal"><span class="pre">SpaceTimeRealign</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nipy.algorithms.registration.chain_transform.html"
                        title="previous chapter">algorithms.registration.chain_transform</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nipy.algorithms.registration.histogram_registration.html"
                        title="next chapter">algorithms.registration.histogram_registration</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/api/generated/nipy.algorithms.registration.groupwise_registration.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>

<div id="searchbox-ml" style="display: none">
  <h3>Search mailing list archive</h3>
  <script type="text/javascript">
    function mlsearch(curobj)
    {
    curobj.q.value="site:http://mail.python.org/pipermail/neuroimaging/ "+curobj.userquery.value
    }
  </script>
  <form action="http://www.google.com/search" method="get" onSubmit="mlsearch(this)">
    <input name="userquery" size="13" type="text" /> <input type="submit" value="Go" />
    <input name="q" type="hidden" />
  </form>
</div>
  
<div id="searchbox-site" style="display: none">
  <h3>Search this site</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="13" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script type="text/javascript">$('#searchbox-ml').show(0);</script>
<script type="text/javascript">$('#searchbox-site').show(0);</script>


        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="algorithms-registration-groupwise-registration">
<h1>algorithms.registration.groupwise_registration<a class="headerlink" href="#algorithms-registration-groupwise-registration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-algorithms-registration-groupwise-registration">
<h2>Module: <code class="xref py py-mod docutils literal"><span class="pre">algorithms.registration.groupwise_registration</span></code><a class="headerlink" href="#module-algorithms-registration-groupwise-registration" title="Permalink to this headline">¶</a></h2>
<p>Inheritance diagram for <code class="docutils literal"><span class="pre">nipy.algorithms.registration.groupwise_registration</span></code>:</p>
<img src="../../_images/inheritance-15a6c606bc9e2143ab92b63cd13b38a311de03e6.png" alt="Inheritance diagram of nipy.algorithms.registration.groupwise_registration" usemap="#inheritance9704126152" class="inheritance"/>
<map id="inheritance9704126152" name="inheritance9704126152">
<area shape="rect" id="node1" href="#nipy.algorithms.registration.groupwise_registration.FmriRealign4d" target="_top" title="registration.groupwise_registration.FmriRealign4d" alt="" coords="424,53,752,78"/>
<area shape="rect" id="node2" href="#nipy.algorithms.registration.groupwise_registration.Realign4d" target="_top" title="registration.groupwise_registration.Realign4d" alt="" coords="36,102,337,127"/>
<area shape="rect" id="node5" href="#nipy.algorithms.registration.groupwise_registration.SpaceRealign" target="_top" title="registration.groupwise_registration.SpaceRealign" alt="" coords="428,102,748,127"/>
<area shape="rect" id="node6" href="#nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign" target="_top" title="registration.groupwise_registration.SpaceTimeRealign" alt="" coords="413,150,763,175"/>
<area shape="rect" id="node3" href="#nipy.algorithms.registration.groupwise_registration.Image4d" target="_top" title="Class to represent a sequence of 3d scans (possibly acquired on a" alt="" coords="40,53,333,78"/>
<area shape="rect" id="node4" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm" target="_top" title="registration.groupwise_registration.Realign4dAlgorithm" alt="" coords="5,5,367,30"/>
</map>
<span class="target" id="module-nipy.algorithms.registration.groupwise_registration"></span><p>Motion correction / motion correction with slice timing

Routines implementing motion correction and motion correction combined with
slice-timing.

See:

Roche, Alexis (2011) A four-dimensional registration algorithm with application
to joint correction of motion and slice timing in fMRI. <em>Medical Imaging, IEEE
Transactions on</em>;  30:1546&#8211;1554</p>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fmrirealign4d">
<h3><a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.FmriRealign4d" title="nipy.algorithms.registration.groupwise_registration.FmriRealign4d"><code class="xref py py-class docutils literal"><span class="pre">FmriRealign4d</span></code></a><a class="headerlink" href="#fmrirealign4d" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.algorithms.registration.groupwise_registration.FmriRealign4d">
<em class="property">class </em><code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">FmriRealign4d</code><span class="sig-paren">(</span><em>images</em>, <em>slice_order=None</em>, <em>tr=None</em>, <em>tr_slices=None</em>, <em>start=0.0</em>, <em>interleaved=None</em>, <em>time_interp=None</em>, <em>slice_times=None</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em>, <em>slice_info=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.FmriRealign4d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.Realign4d" title="nipy.algorithms.registration.groupwise_registration.Realign4d"><code class="xref py py-class docutils literal"><span class="pre">nipy.algorithms.registration.groupwise_registration.Realign4d</span></code></a></p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.FmriRealign4d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>images</em>, <em>slice_order=None</em>, <em>tr=None</em>, <em>tr_slices=None</em>, <em>start=0.0</em>, <em>interleaved=None</em>, <em>time_interp=None</em>, <em>slice_times=None</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em>, <em>slice_info=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.FmriRealign4d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatiotemporal realignment class for fMRI series. This class
is similar to <cite>Realign4d</cite> but provides a more flexible API for
initialization in order to make it easier to declare slice
acquisition times for standard sequences.</p>
<p>Warning: this class is deprecated; please use <a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign" title="nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign"><code class="xref py py-class docutils literal"><span class="pre">SpaceTimeRealign</span></code></a>
instead.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>images</strong> : image or list of images</p>
<blockquote>
<div><p>Single or multiple input 4d images representing one or
several fMRI runs.</p>
</div></blockquote>
<p><strong>slice_order</strong> : str or array-like</p>
<blockquote>
<div><p>If str, one of {&#8216;ascending&#8217;, &#8216;descending&#8217;}. If array-like,
then the order in which the slices were collected in
time. For instance, the following represents an ascending
contiguous sequence:</p>
<p>slice_order = [0, 1, 2, ...]</p>
<p>Note that <cite>slice_order</cite> differs from the argument used
e.g. in the SPM slice timing routine in that it maps spatial
slice positions to slice times. It is a mapping from space
to time, while SPM conventionally uses the reverse mapping
from time to space. For example, for an interleaved sequence
with 10 slices, where we acquired slice 0 (in space) first,
then slice 2 (in space) etc, <cite>slice_order</cite> would be [0, 5,
1, 6, 2, 7, 3, 8, 4, 9]</p>
<p>Using <cite>slice_order</cite> assumes that the inter-slice acquisition
time is constant throughout acquisition. If this is not the
case, use the <cite>slice_times</cite> argument instead and leave
<cite>slice_order</cite> to None.</p>
</div></blockquote>
<p><strong>tr</strong> : float</p>
<blockquote>
<div><p>Inter-scan repetition time, i.e. the time elapsed between
two consecutive scans. The unit in which <cite>tr</cite> is given is
arbitrary although it needs to be consistent with the
<cite>tr_slices</cite> and <cite>start</cite> arguments if provided. If None, <cite>tr</cite>
is computed internally assuming a regular slice acquisition
scheme.</p>
</div></blockquote>
<p><strong>tr_slices</strong> : float</p>
<blockquote>
<div><p>Inter-slice repetition time, same as <cite>tr</cite> for slices. If
None, acquisition is assumed regular and <cite>tr_slices</cite> is set
to <cite>tr</cite> divided by the number of slices.</p>
</div></blockquote>
<p><strong>start</strong> : float</p>
<blockquote>
<div><p>Starting acquisition time (time of the first acquired slice)
respective to the time origin for resampling. <cite>start</cite> is
assumed to be given in the same unit as <cite>tr</cite>. Setting
<cite>start=0</cite> means that the resampled data will be synchronous
with the first acquired slice. Setting <cite>start=-tr/2</cite> means
that the resampled data will be synchronous with the slice
acquired at half repetition time.</p>
</div></blockquote>
<p><strong>time_interp: bool</strong></p>
<blockquote>
<div><p>Tells whether time interpolation is used or not within the
realignment algorithm. If False, slices are considered to be
acquired all at the same time, thus no slice timing
correction will be performed.</p>
</div></blockquote>
<p><strong>interleaved</strong> : bool</p>
<blockquote>
<div><p>Deprecated argument.</p>
<p>Tells whether slice acquisition order is interleaved in a
certain sense. Setting <cite>interleaved</cite> to True or False will
trigger an error unless <cite>slice_order</cite> is &#8216;ascending&#8217; or
&#8216;descending&#8217; and <cite>slice_times</cite> is None.</p>
<p>If slice_order==&#8217;ascending&#8217; and interleaved==True, the
assumed slice order is (assuming 10 slices):</p>
<p>[0, 5, 1, 6, 2, 7, 3, 8, 4, 9]</p>
<p>If slice_order==&#8217;descending&#8217; and interleaved==True, the
assumed slice order is:</p>
<p>[9, 4, 8, 3, 7, 2, 6, 1, 5, 0]</p>
<p>WARNING: given that there exist other types of interleaved
acquisitions depending on scanner settings and
manufacturers, you should refrain from using the
<cite>interleaved</cite> keyword argument unless you are sure what you
are doing. It is generally safer to explicitly input
<cite>slice_order</cite> or <cite>slice_times</cite>.</p>
</div></blockquote>
<p><strong>slice_times</strong> : None, str or array-like</p>
<blockquote>
<div><p>This argument can be used instead of <cite>slice_order</cite>,
<cite>tr_slices</cite>, <cite>start</cite> and <cite>time_interp</cite> altogether.</p>
<p>If None, slices are assumed to be acquired simultaneously
hence no slice timing correction is performed. If
array-like, then <cite>slice_times</cite> gives the slice acquisition
times along the slice axis in units that are consistent with
the provided <cite>tr</cite>.</p>
<p>Generally speaking, the following holds for sequences with
constant inter-slice repetition time <cite>tr_slices</cite>:</p>
<p><cite>slice_times</cite> = <cite>start</cite> + <cite>tr_slices</cite> * <cite>slice_order</cite></p>
<p>For other sequences such as, e.g., sequences with
simultaneously acquired slices, it is necessary to input
<cite>slice_times</cite> explicitly along with <cite>tr</cite>.</p>
</div></blockquote>
<p><strong>slice_info</strong> : None or tuple, optional</p>
<blockquote class="last">
<div><p>None, or a tuple with slice axis as the first element and
direction as the second, for instance (2, 1). If None, then
the slice axis and direction are guessed from the first
run&#8217;s affine assuming that slices are collected along the
closest axis to the z-axis. This means that we assume by
default an axial acquisition with slice axis pointing from
bottom to top of the head.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.FmriRealign4d.estimate">
<code class="descname">estimate</code><span class="sig-paren">(</span><em>loops=5</em>, <em>between_loops=None</em>, <em>align_runs=True</em>, <em>speedup=5</em>, <em>refscan=0</em>, <em>borders=(1</em>, <em>1</em>, <em>1)</em>, <em>optimizer='ncg'</em>, <em>xtol=1e-05</em>, <em>ftol=1e-05</em>, <em>gtol=1e-05</em>, <em>stepsize=1e-06</em>, <em>maxiter=64</em>, <em>maxfun=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.FmriRealign4d.estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Estimate motion parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>loops</strong> : int or sequence of ints</p>
<blockquote>
<div><p>Determines the number of iterations performed to realign
scans within each run for each pass defined by the
<code class="docutils literal"><span class="pre">speedup</span></code> argument. For instance, setting <code class="docutils literal"><span class="pre">speedup</span></code> ==
(5,2) and <code class="docutils literal"><span class="pre">loops</span></code> == (5,1) means that 5 iterations are
performed in a first pass where scans are subsampled by an
isotropic factor 5, followed by one iteration where scans
are subsampled by a factor 2.</p>
</div></blockquote>
<p><strong>between_loops</strong> : None, int or sequence of ints</p>
<blockquote>
<div><p>Similar to <code class="docutils literal"><span class="pre">loops</span></code> for between-run motion
estimation. Determines the number of iterations used to
realign scans across runs, a procedure similar to
within-run realignment that uses the mean images from each
run. If None, assumed to be the same as <code class="docutils literal"><span class="pre">loops</span></code>.
The setting used in the experiments described in Roche,
IEEE TMI 2011, was: <code class="docutils literal"><span class="pre">speedup</span></code> = (5, 2), <code class="docutils literal"><span class="pre">loops</span></code> = (5,
1) and <code class="docutils literal"><span class="pre">between_loops</span></code> = (5, 1).</p>
</div></blockquote>
<p><strong>align_runs</strong> : bool</p>
<blockquote>
<div><p>Determines whether between-run motion is estimated or
not. If False, the <code class="docutils literal"><span class="pre">between_loops</span></code> argument is ignored.</p>
</div></blockquote>
<p><strong>speedup: int or sequence of ints</strong></p>
<blockquote>
<div><p>Determines an isotropic sub-sampling factor, or a sequence
of such factors, applied to the scans to perform motion
estimation. If a sequence, several estimation passes are
applied.</p>
</div></blockquote>
<p><strong>refscan</strong> : None or int</p>
<blockquote>
<div><p>Defines the number of the scan used as the reference
coordinate system for each run. If None, a reference
coordinate system is defined internally that does not
correspond to any particular scan. Note that the
coordinate system associated with the first run is always</p>
</div></blockquote>
<p><strong>borders</strong> : sequence of ints</p>
<blockquote>
<div><p>Should be of length 3. Determines the field of view for
motion estimation in terms of the number of slices at each
extremity of the reference grid that are ignored for
motion parameter estimation. For instance,
<code class="docutils literal"><span class="pre">borders``==(1,1,1)</span> <span class="pre">means</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">realignment</span> <span class="pre">cost</span>
<span class="pre">function</span> <span class="pre">will</span> <span class="pre">not</span> <span class="pre">take</span> <span class="pre">into</span> <span class="pre">account</span> <span class="pre">voxels</span> <span class="pre">located</span> <span class="pre">in</span> <span class="pre">the</span>
<span class="pre">first</span> <span class="pre">and</span> <span class="pre">last</span> <span class="pre">axial/sagittal/coronal</span> <span class="pre">slices</span> <span class="pre">in</span> <span class="pre">the</span>
<span class="pre">reference</span> <span class="pre">grid.</span> <span class="pre">Please</span> <span class="pre">note</span> <span class="pre">that</span> <span class="pre">this</span> <span class="pre">choice</span> <span class="pre">only</span> <span class="pre">affects</span>
<span class="pre">parameter</span> <span class="pre">estimation</span> <span class="pre">but</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">affect</span> <span class="pre">image</span> <span class="pre">resampling</span>
<span class="pre">in</span> <span class="pre">any</span> <span class="pre">way,</span> <span class="pre">see</span> <span class="pre">``resample</span></code> method.</p>
</div></blockquote>
<p><strong>optimizer</strong> : str</p>
<blockquote>
<div><p>Defines the optimization method. One of &#8216;simplex&#8217;,
&#8216;powell&#8217;, &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217; and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>xtol</strong> : float</p>
<blockquote>
<div><p>Tolerance on variations of transformation parameters to
test numerical convergence.</p>
</div></blockquote>
<p><strong>ftol</strong> : float</p>
<blockquote>
<div><p>Tolerance on variations of the intensity comparison metric
to test numerical convergence.</p>
</div></blockquote>
<p><strong>gtol</strong> : float</p>
<blockquote>
<div><p>Tolerance on the gradient of the intensity comparison
metric to test numerical convergence. Applicable to
optimizers &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217; and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>stepsize</strong> : float</p>
<blockquote>
<div><p>Step size to approximate the gradient and Hessian of the
intensity comparison metric w.r.t. transformation
parameters. Applicable to optimizers &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217;
and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int</p>
<blockquote>
<div><p>Maximum number of iterations in optimization.</p>
</div></blockquote>
<p><strong>maxfun</strong> : int</p>
<blockquote class="last">
<div><p>Maximum number of function evaluations in maxfun.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.FmriRealign4d.resample">
<code class="descname">resample</code><span class="sig-paren">(</span><em>r=None</em>, <em>align_runs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.FmriRealign4d.resample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the resampled run number r as a 4d nipy-like
image. Returns all runs as a list of images if r is None.</p>
</dd></dl>

</div>
<div class="section" id="image4d">
<h3><a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.Image4d" title="nipy.algorithms.registration.groupwise_registration.Image4d"><code class="xref py py-class docutils literal"><span class="pre">Image4d</span></code></a><a class="headerlink" href="#image4d" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.algorithms.registration.groupwise_registration.Image4d">
<em class="property">class </em><code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">Image4d</code><span class="sig-paren">(</span><em>data</em>, <em>affine</em>, <em>tr</em>, <em>slice_times</em>, <em>slice_info=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Image4d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class to represent a sequence of 3d scans (possibly acquired on a
slice-by-slice basis).</p>
<p>Object remains empty until the data array is actually loaded in memory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> : nd array or proxy (function that actually gets the array)</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Image4d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>data</em>, <em>affine</em>, <em>tr</em>, <em>slice_times</em>, <em>slice_info=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Image4d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure fMRI acquisition time parameters.</p>
</dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Image4d.free_data">
<code class="descname">free_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Image4d.free_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Image4d.get_data">
<code class="descname">get_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Image4d.get_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Image4d.get_shape">
<code class="descname">get_shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Image4d.get_shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Image4d.scanner_time">
<code class="descname">scanner_time</code><span class="sig-paren">(</span><em>zv</em>, <em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Image4d.scanner_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>tv = scanner_time(zv, t)
zv, tv are grid coordinates; t is an actual time value.</p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Image4d.z_to_slice">
<code class="descname">z_to_slice</code><span class="sig-paren">(</span><em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Image4d.z_to_slice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Account for the fact that slices may be stored in reverse
order wrt the scanner coordinate system convention (slice 0 ==
bottom of the head)</p>
</dd></dl>

</div>
<div class="section" id="realign4d">
<h3><a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.Realign4d" title="nipy.algorithms.registration.groupwise_registration.Realign4d"><code class="xref py py-class docutils literal"><span class="pre">Realign4d</span></code></a><a class="headerlink" href="#realign4d" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4d">
<em class="property">class </em><code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">Realign4d</code><span class="sig-paren">(</span><em>images</em>, <em>tr</em>, <em>slice_times=None</em>, <em>slice_info=None</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4d.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>images</em>, <em>tr</em>, <em>slice_times=None</em>, <em>slice_info=None</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4d.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatiotemporal realignment class for series of 3D images.</p>
<p>The algorithm performs simultaneous motion and slice timing
correction for fMRI series or other data where slices are not
acquired simultaneously.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>images</strong> : image or list of images</p>
<blockquote>
<div><p>Single or multiple input 4d images representing one or
several sessions.</p>
</div></blockquote>
<p><strong>tr</strong> : float</p>
<blockquote>
<div><p>Inter-scan repetition time, i.e. the time elapsed between
two consecutive scans. The unit in which <cite>tr</cite> is given is
arbitrary although it needs to be consistent with the
<cite>slice_times</cite> argument.</p>
</div></blockquote>
<p><strong>slice_times</strong> : None or array-like</p>
<blockquote>
<div><p>If None, slices are assumed to be acquired simultaneously
hence no slice timing correction is performed. If
array-like, then the slice acquisition times.</p>
</div></blockquote>
<p><strong>slice_info</strong> : None or tuple, optional</p>
<blockquote class="last">
<div><p>None, or a tuple with slice axis as the first element and
direction as the second, for instance (2, 1).  If None, then
guess the slice axis, and direction, as the closest to the z
axis, as estimated from the affine.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4d.estimate">
<code class="descname">estimate</code><span class="sig-paren">(</span><em>loops=5</em>, <em>between_loops=None</em>, <em>align_runs=True</em>, <em>speedup=5</em>, <em>refscan=0</em>, <em>borders=(1</em>, <em>1</em>, <em>1)</em>, <em>optimizer='ncg'</em>, <em>xtol=1e-05</em>, <em>ftol=1e-05</em>, <em>gtol=1e-05</em>, <em>stepsize=1e-06</em>, <em>maxiter=64</em>, <em>maxfun=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4d.estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Estimate motion parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>loops</strong> : int or sequence of ints</p>
<blockquote>
<div><p>Determines the number of iterations performed to realign
scans within each run for each pass defined by the
<code class="docutils literal"><span class="pre">speedup</span></code> argument. For instance, setting <code class="docutils literal"><span class="pre">speedup</span></code> ==
(5,2) and <code class="docutils literal"><span class="pre">loops</span></code> == (5,1) means that 5 iterations are
performed in a first pass where scans are subsampled by an
isotropic factor 5, followed by one iteration where scans
are subsampled by a factor 2.</p>
</div></blockquote>
<p><strong>between_loops</strong> : None, int or sequence of ints</p>
<blockquote>
<div><p>Similar to <code class="docutils literal"><span class="pre">loops</span></code> for between-run motion
estimation. Determines the number of iterations used to
realign scans across runs, a procedure similar to
within-run realignment that uses the mean images from each
run. If None, assumed to be the same as <code class="docutils literal"><span class="pre">loops</span></code>.
The setting used in the experiments described in Roche,
IEEE TMI 2011, was: <code class="docutils literal"><span class="pre">speedup</span></code> = (5, 2), <code class="docutils literal"><span class="pre">loops</span></code> = (5,
1) and <code class="docutils literal"><span class="pre">between_loops</span></code> = (5, 1).</p>
</div></blockquote>
<p><strong>align_runs</strong> : bool</p>
<blockquote>
<div><p>Determines whether between-run motion is estimated or
not. If False, the <code class="docutils literal"><span class="pre">between_loops</span></code> argument is ignored.</p>
</div></blockquote>
<p><strong>speedup: int or sequence of ints</strong></p>
<blockquote>
<div><p>Determines an isotropic sub-sampling factor, or a sequence
of such factors, applied to the scans to perform motion
estimation. If a sequence, several estimation passes are
applied.</p>
</div></blockquote>
<p><strong>refscan</strong> : None or int</p>
<blockquote>
<div><p>Defines the number of the scan used as the reference
coordinate system for each run. If None, a reference
coordinate system is defined internally that does not
correspond to any particular scan. Note that the
coordinate system associated with the first run is always</p>
</div></blockquote>
<p><strong>borders</strong> : sequence of ints</p>
<blockquote>
<div><p>Should be of length 3. Determines the field of view for
motion estimation in terms of the number of slices at each
extremity of the reference grid that are ignored for
motion parameter estimation. For instance,
<code class="docutils literal"><span class="pre">borders``==(1,1,1)</span> <span class="pre">means</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">realignment</span> <span class="pre">cost</span>
<span class="pre">function</span> <span class="pre">will</span> <span class="pre">not</span> <span class="pre">take</span> <span class="pre">into</span> <span class="pre">account</span> <span class="pre">voxels</span> <span class="pre">located</span> <span class="pre">in</span> <span class="pre">the</span>
<span class="pre">first</span> <span class="pre">and</span> <span class="pre">last</span> <span class="pre">axial/sagittal/coronal</span> <span class="pre">slices</span> <span class="pre">in</span> <span class="pre">the</span>
<span class="pre">reference</span> <span class="pre">grid.</span> <span class="pre">Please</span> <span class="pre">note</span> <span class="pre">that</span> <span class="pre">this</span> <span class="pre">choice</span> <span class="pre">only</span> <span class="pre">affects</span>
<span class="pre">parameter</span> <span class="pre">estimation</span> <span class="pre">but</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">affect</span> <span class="pre">image</span> <span class="pre">resampling</span>
<span class="pre">in</span> <span class="pre">any</span> <span class="pre">way,</span> <span class="pre">see</span> <span class="pre">``resample</span></code> method.</p>
</div></blockquote>
<p><strong>optimizer</strong> : str</p>
<blockquote>
<div><p>Defines the optimization method. One of &#8216;simplex&#8217;,
&#8216;powell&#8217;, &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217; and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>xtol</strong> : float</p>
<blockquote>
<div><p>Tolerance on variations of transformation parameters to
test numerical convergence.</p>
</div></blockquote>
<p><strong>ftol</strong> : float</p>
<blockquote>
<div><p>Tolerance on variations of the intensity comparison metric
to test numerical convergence.</p>
</div></blockquote>
<p><strong>gtol</strong> : float</p>
<blockquote>
<div><p>Tolerance on the gradient of the intensity comparison
metric to test numerical convergence. Applicable to
optimizers &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217; and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>stepsize</strong> : float</p>
<blockquote>
<div><p>Step size to approximate the gradient and Hessian of the
intensity comparison metric w.r.t. transformation
parameters. Applicable to optimizers &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217;
and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int</p>
<blockquote>
<div><p>Maximum number of iterations in optimization.</p>
</div></blockquote>
<p><strong>maxfun</strong> : int</p>
<blockquote class="last">
<div><p>Maximum number of function evaluations in maxfun.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4d.resample">
<code class="descname">resample</code><span class="sig-paren">(</span><em>r=None</em>, <em>align_runs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4d.resample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the resampled run number r as a 4d nipy-like
image. Returns all runs as a list of images if r is None.</p>
</dd></dl>

</div>
<div class="section" id="realign4dalgorithm">
<h3><a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm" title="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm"><code class="xref py py-class docutils literal"><span class="pre">Realign4dAlgorithm</span></code></a><a class="headerlink" href="#realign4dalgorithm" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm">
<em class="property">class </em><code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">Realign4dAlgorithm</code><span class="sig-paren">(</span><em>im4d</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em>, <em>transforms=None</em>, <em>time_interp=True</em>, <em>subsampling=(1</em>, <em>1</em>, <em>1)</em>, <em>refscan=0</em>, <em>borders=(1</em>, <em>1</em>, <em>1)</em>, <em>optimizer='ncg'</em>, <em>optimize_template=True</em>, <em>xtol=1e-05</em>, <em>ftol=1e-05</em>, <em>gtol=1e-05</em>, <em>stepsize=1e-06</em>, <em>maxiter=64</em>, <em>maxfun=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>im4d</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em>, <em>transforms=None</em>, <em>time_interp=True</em>, <em>subsampling=(1</em>, <em>1</em>, <em>1)</em>, <em>refscan=0</em>, <em>borders=(1</em>, <em>1</em>, <em>1)</em>, <em>optimizer='ncg'</em>, <em>optimize_template=True</em>, <em>xtol=1e-05</em>, <em>ftol=1e-05</em>, <em>gtol=1e-05</em>, <em>stepsize=1e-06</em>, <em>maxiter=64</em>, <em>maxfun=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.align_to_refscan">
<code class="descname">align_to_refscan</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.align_to_refscan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The <cite>motion_estimate</cite> method aligns scans with an online
template so that spatial transforms map some average head
space to the scanner space. To conventionally redefine the
head space as being aligned with some reference scan, we need
to right compose each head_average-to-scanner transform with
the refscan&#8217;s &#8216;to head_average&#8217; transform.</p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.estimate_instant_motion">
<code class="descname">estimate_instant_motion</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.estimate_instant_motion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Estimate motion parameters at a particular time.</p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.estimate_motion">
<code class="descname">estimate_motion</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.estimate_motion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Optimize motion parameters for the whole sequence. All the
time frames are initially resampled according to the current
space/time transformation, the parameters of which are further
optimized sequentially.</p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.init_instant_motion">
<code class="descname">init_instant_motion</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.init_instant_motion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Pre-compute and cache some constants (at fixed time) for
repeated computations of the alignment energy.</p>
<p>The idea is to decompose the average temporal variance via:</p>
<p>V = (n-1)/n V* + (n-1)/n^2 (x-m*)^2</p>
<p>with x the considered volume at time t, and m* the mean of all
resampled volumes but x. Only the second term is variable when</p>
<p>one volumes while the others are fixed. A similar
decomposition is used for the global variance, so we end up
with:</p>
<p>V/V0 = [nV* + (x-m*)^2] / [nV0* + (x-m0*)^2]</p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.resample">
<code class="descname">resample</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.resample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Resample a particular time frame on the (sub-sampled) working
grid.</p>
<p>x,y,z,t are &#8220;head&#8221; grid coordinates
X,Y,Z,T are &#8220;scanner&#8221; grid coordinates</p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.resample_full_data">
<code class="descname">resample_full_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.resample_full_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.set_fmin">
<code class="descname">set_fmin</code><span class="sig-paren">(</span><em>optimizer</em>, <em>stepsize</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.set_fmin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the minimization function</p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.set_transform">
<code class="descname">set_transform</code><span class="sig-paren">(</span><em>t</em>, <em>pc</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.Realign4dAlgorithm.set_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="spacerealign">
<h3><a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.SpaceRealign" title="nipy.algorithms.registration.groupwise_registration.SpaceRealign"><code class="xref py py-class docutils literal"><span class="pre">SpaceRealign</span></code></a><a class="headerlink" href="#spacerealign" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.algorithms.registration.groupwise_registration.SpaceRealign">
<em class="property">class </em><code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">SpaceRealign</code><span class="sig-paren">(</span><em>images</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.SpaceRealign" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.Realign4d" title="nipy.algorithms.registration.groupwise_registration.Realign4d"><code class="xref py py-class docutils literal"><span class="pre">nipy.algorithms.registration.groupwise_registration.Realign4d</span></code></a></p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.SpaceRealign.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>images</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.SpaceRealign.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial registration of time series with no time interpolation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>images</strong> : image or list of images</p>
<blockquote>
<div><p>Single or multiple input 4d images representing one or several fMRI
runs.</p>
</div></blockquote>
<p><strong>affine_class</strong> : <code class="docutils literal"><span class="pre">Affine</span></code> class, optional</p>
<blockquote class="last">
<div><p>transformation class to use to calculate transformations between
the volumes. Default is :class:<code class="docutils literal"><span class="pre">Rigid</span></code></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.SpaceRealign.estimate">
<code class="descname">estimate</code><span class="sig-paren">(</span><em>loops=5</em>, <em>between_loops=None</em>, <em>align_runs=True</em>, <em>speedup=5</em>, <em>refscan=0</em>, <em>borders=(1</em>, <em>1</em>, <em>1)</em>, <em>optimizer='ncg'</em>, <em>xtol=1e-05</em>, <em>ftol=1e-05</em>, <em>gtol=1e-05</em>, <em>stepsize=1e-06</em>, <em>maxiter=64</em>, <em>maxfun=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.SpaceRealign.estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Estimate motion parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>loops</strong> : int or sequence of ints</p>
<blockquote>
<div><p>Determines the number of iterations performed to realign
scans within each run for each pass defined by the
<code class="docutils literal"><span class="pre">speedup</span></code> argument. For instance, setting <code class="docutils literal"><span class="pre">speedup</span></code> ==
(5,2) and <code class="docutils literal"><span class="pre">loops</span></code> == (5,1) means that 5 iterations are
performed in a first pass where scans are subsampled by an
isotropic factor 5, followed by one iteration where scans
are subsampled by a factor 2.</p>
</div></blockquote>
<p><strong>between_loops</strong> : None, int or sequence of ints</p>
<blockquote>
<div><p>Similar to <code class="docutils literal"><span class="pre">loops</span></code> for between-run motion
estimation. Determines the number of iterations used to
realign scans across runs, a procedure similar to
within-run realignment that uses the mean images from each
run. If None, assumed to be the same as <code class="docutils literal"><span class="pre">loops</span></code>.
The setting used in the experiments described in Roche,
IEEE TMI 2011, was: <code class="docutils literal"><span class="pre">speedup</span></code> = (5, 2), <code class="docutils literal"><span class="pre">loops</span></code> = (5,
1) and <code class="docutils literal"><span class="pre">between_loops</span></code> = (5, 1).</p>
</div></blockquote>
<p><strong>align_runs</strong> : bool</p>
<blockquote>
<div><p>Determines whether between-run motion is estimated or
not. If False, the <code class="docutils literal"><span class="pre">between_loops</span></code> argument is ignored.</p>
</div></blockquote>
<p><strong>speedup: int or sequence of ints</strong></p>
<blockquote>
<div><p>Determines an isotropic sub-sampling factor, or a sequence
of such factors, applied to the scans to perform motion
estimation. If a sequence, several estimation passes are
applied.</p>
</div></blockquote>
<p><strong>refscan</strong> : None or int</p>
<blockquote>
<div><p>Defines the number of the scan used as the reference
coordinate system for each run. If None, a reference
coordinate system is defined internally that does not
correspond to any particular scan. Note that the
coordinate system associated with the first run is always</p>
</div></blockquote>
<p><strong>borders</strong> : sequence of ints</p>
<blockquote>
<div><p>Should be of length 3. Determines the field of view for
motion estimation in terms of the number of slices at each
extremity of the reference grid that are ignored for
motion parameter estimation. For instance,
<code class="docutils literal"><span class="pre">borders``==(1,1,1)</span> <span class="pre">means</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">realignment</span> <span class="pre">cost</span>
<span class="pre">function</span> <span class="pre">will</span> <span class="pre">not</span> <span class="pre">take</span> <span class="pre">into</span> <span class="pre">account</span> <span class="pre">voxels</span> <span class="pre">located</span> <span class="pre">in</span> <span class="pre">the</span>
<span class="pre">first</span> <span class="pre">and</span> <span class="pre">last</span> <span class="pre">axial/sagittal/coronal</span> <span class="pre">slices</span> <span class="pre">in</span> <span class="pre">the</span>
<span class="pre">reference</span> <span class="pre">grid.</span> <span class="pre">Please</span> <span class="pre">note</span> <span class="pre">that</span> <span class="pre">this</span> <span class="pre">choice</span> <span class="pre">only</span> <span class="pre">affects</span>
<span class="pre">parameter</span> <span class="pre">estimation</span> <span class="pre">but</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">affect</span> <span class="pre">image</span> <span class="pre">resampling</span>
<span class="pre">in</span> <span class="pre">any</span> <span class="pre">way,</span> <span class="pre">see</span> <span class="pre">``resample</span></code> method.</p>
</div></blockquote>
<p><strong>optimizer</strong> : str</p>
<blockquote>
<div><p>Defines the optimization method. One of &#8216;simplex&#8217;,
&#8216;powell&#8217;, &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217; and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>xtol</strong> : float</p>
<blockquote>
<div><p>Tolerance on variations of transformation parameters to
test numerical convergence.</p>
</div></blockquote>
<p><strong>ftol</strong> : float</p>
<blockquote>
<div><p>Tolerance on variations of the intensity comparison metric
to test numerical convergence.</p>
</div></blockquote>
<p><strong>gtol</strong> : float</p>
<blockquote>
<div><p>Tolerance on the gradient of the intensity comparison
metric to test numerical convergence. Applicable to
optimizers &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217; and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>stepsize</strong> : float</p>
<blockquote>
<div><p>Step size to approximate the gradient and Hessian of the
intensity comparison metric w.r.t. transformation
parameters. Applicable to optimizers &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217;
and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int</p>
<blockquote>
<div><p>Maximum number of iterations in optimization.</p>
</div></blockquote>
<p><strong>maxfun</strong> : int</p>
<blockquote class="last">
<div><p>Maximum number of function evaluations in maxfun.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.SpaceRealign.resample">
<code class="descname">resample</code><span class="sig-paren">(</span><em>r=None</em>, <em>align_runs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.SpaceRealign.resample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the resampled run number r as a 4d nipy-like
image. Returns all runs as a list of images if r is None.</p>
</dd></dl>

</div>
<div class="section" id="spacetimerealign">
<h3><a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign" title="nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign"><code class="xref py py-class docutils literal"><span class="pre">SpaceTimeRealign</span></code></a><a class="headerlink" href="#spacetimerealign" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign">
<em class="property">class </em><code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">SpaceTimeRealign</code><span class="sig-paren">(</span><em>images</em>, <em>tr</em>, <em>slice_times</em>, <em>slice_info</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.Realign4d" title="nipy.algorithms.registration.groupwise_registration.Realign4d"><code class="xref py py-class docutils literal"><span class="pre">nipy.algorithms.registration.groupwise_registration.Realign4d</span></code></a></p>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>images</em>, <em>tr</em>, <em>slice_times</em>, <em>slice_info</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatiotemporal realignment class for fMRI series.</p>
<p>This class gives a high-level interface to <a class="reference internal" href="#nipy.algorithms.registration.groupwise_registration.Realign4d" title="nipy.algorithms.registration.groupwise_registration.Realign4d"><code class="xref py py-class docutils literal"><span class="pre">Realign4d</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>images</strong> : image or list of images</p>
<blockquote>
<div><p>Single or multiple input 4d images representing one or several fMRI
runs.</p>
</div></blockquote>
<p><strong>tr</strong> : None or float or &#8220;header-allow-1.0&#8221;</p>
<blockquote>
<div><p>Inter-scan repetition time in seconds, i.e. the time elapsed between
two consecutive scans. If None, an attempt is made to read the TR
from the header, but an exception is thrown for values 0 or 1. A
value of &#8220;header-allow-1.0&#8221; will signal to accept a header TR of 1.</p>
</div></blockquote>
<p><strong>slice_times</strong> : str or callable or array-like</p>
<blockquote>
<div><p>If str, one of the function names in <code class="docutils literal"><span class="pre">SLICETIME_FUNCTIONS</span></code>
dictionary from <a class="reference internal" href="nipy.algorithms.slicetiming.timefuncs.html#module-nipy.algorithms.slicetiming.timefuncs" title="nipy.algorithms.slicetiming.timefuncs"><code class="xref py py-mod docutils literal"><span class="pre">nipy.algorithms.slicetiming.timefuncs</span></code></a>.  If
callable, a function taking two parameters: <code class="docutils literal"><span class="pre">n_slices</span></code> and <code class="docutils literal"><span class="pre">tr</span></code>
(number of slices in the images, inter-scan repetition time in
seconds). This function returns a vector of times of slice
acquisition <span class="math">\(t_i\)</span> for each slice <span class="math">\(i\)</span> in the volumes.  See
<a class="reference internal" href="nipy.algorithms.slicetiming.timefuncs.html#module-nipy.algorithms.slicetiming.timefuncs" title="nipy.algorithms.slicetiming.timefuncs"><code class="xref py py-mod docutils literal"><span class="pre">nipy.algorithms.slicetiming.timefuncs</span></code></a> for a collection of
functions for common slice acquisition schemes. If array-like, then
should be a slice time vector as above.</p>
</div></blockquote>
<p><strong>slice_info</strong> : int or length 2 sequence</p>
<blockquote>
<div><p>If int, the axis in <cite>images</cite> that is the slice axis.  In a 4D image,
this will often be axis = 2.  If a 2 sequence, then elements are
<code class="docutils literal"><span class="pre">(slice_axis,</span> <span class="pre">slice_direction)</span></code>, where <code class="docutils literal"><span class="pre">slice_axis</span></code> is the slice
axis in the image as above, and <code class="docutils literal"><span class="pre">slice_direction</span></code> is 1 if the
slices were acquired slice 0 first, slice -1 last, or -1 if acquired
slice -1 first, slice 0 last.  If <cite>slice_info</cite> is an int, assume
<code class="docutils literal"><span class="pre">slice_direction</span></code> == 1.</p>
</div></blockquote>
<p><strong>affine_class</strong> : <code class="docutils literal"><span class="pre">Affine</span></code> class, optional</p>
<blockquote class="last">
<div><p>transformation class to use to calculate transformations between
the volumes. Default is :class:<code class="docutils literal"><span class="pre">Rigid</span></code></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign.estimate">
<code class="descname">estimate</code><span class="sig-paren">(</span><em>loops=5</em>, <em>between_loops=None</em>, <em>align_runs=True</em>, <em>speedup=5</em>, <em>refscan=0</em>, <em>borders=(1</em>, <em>1</em>, <em>1)</em>, <em>optimizer='ncg'</em>, <em>xtol=1e-05</em>, <em>ftol=1e-05</em>, <em>gtol=1e-05</em>, <em>stepsize=1e-06</em>, <em>maxiter=64</em>, <em>maxfun=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign.estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Estimate motion parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>loops</strong> : int or sequence of ints</p>
<blockquote>
<div><p>Determines the number of iterations performed to realign
scans within each run for each pass defined by the
<code class="docutils literal"><span class="pre">speedup</span></code> argument. For instance, setting <code class="docutils literal"><span class="pre">speedup</span></code> ==
(5,2) and <code class="docutils literal"><span class="pre">loops</span></code> == (5,1) means that 5 iterations are
performed in a first pass where scans are subsampled by an
isotropic factor 5, followed by one iteration where scans
are subsampled by a factor 2.</p>
</div></blockquote>
<p><strong>between_loops</strong> : None, int or sequence of ints</p>
<blockquote>
<div><p>Similar to <code class="docutils literal"><span class="pre">loops</span></code> for between-run motion
estimation. Determines the number of iterations used to
realign scans across runs, a procedure similar to
within-run realignment that uses the mean images from each
run. If None, assumed to be the same as <code class="docutils literal"><span class="pre">loops</span></code>.
The setting used in the experiments described in Roche,
IEEE TMI 2011, was: <code class="docutils literal"><span class="pre">speedup</span></code> = (5, 2), <code class="docutils literal"><span class="pre">loops</span></code> = (5,
1) and <code class="docutils literal"><span class="pre">between_loops</span></code> = (5, 1).</p>
</div></blockquote>
<p><strong>align_runs</strong> : bool</p>
<blockquote>
<div><p>Determines whether between-run motion is estimated or
not. If False, the <code class="docutils literal"><span class="pre">between_loops</span></code> argument is ignored.</p>
</div></blockquote>
<p><strong>speedup: int or sequence of ints</strong></p>
<blockquote>
<div><p>Determines an isotropic sub-sampling factor, or a sequence
of such factors, applied to the scans to perform motion
estimation. If a sequence, several estimation passes are
applied.</p>
</div></blockquote>
<p><strong>refscan</strong> : None or int</p>
<blockquote>
<div><p>Defines the number of the scan used as the reference
coordinate system for each run. If None, a reference
coordinate system is defined internally that does not
correspond to any particular scan. Note that the
coordinate system associated with the first run is always</p>
</div></blockquote>
<p><strong>borders</strong> : sequence of ints</p>
<blockquote>
<div><p>Should be of length 3. Determines the field of view for
motion estimation in terms of the number of slices at each
extremity of the reference grid that are ignored for
motion parameter estimation. For instance,
<code class="docutils literal"><span class="pre">borders``==(1,1,1)</span> <span class="pre">means</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">realignment</span> <span class="pre">cost</span>
<span class="pre">function</span> <span class="pre">will</span> <span class="pre">not</span> <span class="pre">take</span> <span class="pre">into</span> <span class="pre">account</span> <span class="pre">voxels</span> <span class="pre">located</span> <span class="pre">in</span> <span class="pre">the</span>
<span class="pre">first</span> <span class="pre">and</span> <span class="pre">last</span> <span class="pre">axial/sagittal/coronal</span> <span class="pre">slices</span> <span class="pre">in</span> <span class="pre">the</span>
<span class="pre">reference</span> <span class="pre">grid.</span> <span class="pre">Please</span> <span class="pre">note</span> <span class="pre">that</span> <span class="pre">this</span> <span class="pre">choice</span> <span class="pre">only</span> <span class="pre">affects</span>
<span class="pre">parameter</span> <span class="pre">estimation</span> <span class="pre">but</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">affect</span> <span class="pre">image</span> <span class="pre">resampling</span>
<span class="pre">in</span> <span class="pre">any</span> <span class="pre">way,</span> <span class="pre">see</span> <span class="pre">``resample</span></code> method.</p>
</div></blockquote>
<p><strong>optimizer</strong> : str</p>
<blockquote>
<div><p>Defines the optimization method. One of &#8216;simplex&#8217;,
&#8216;powell&#8217;, &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217; and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>xtol</strong> : float</p>
<blockquote>
<div><p>Tolerance on variations of transformation parameters to
test numerical convergence.</p>
</div></blockquote>
<p><strong>ftol</strong> : float</p>
<blockquote>
<div><p>Tolerance on variations of the intensity comparison metric
to test numerical convergence.</p>
</div></blockquote>
<p><strong>gtol</strong> : float</p>
<blockquote>
<div><p>Tolerance on the gradient of the intensity comparison
metric to test numerical convergence. Applicable to
optimizers &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217; and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>stepsize</strong> : float</p>
<blockquote>
<div><p>Step size to approximate the gradient and Hessian of the
intensity comparison metric w.r.t. transformation
parameters. Applicable to optimizers &#8216;cg&#8217;, &#8216;ncg&#8217;, &#8216;bfgs&#8217;
and &#8216;steepest&#8217;.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int</p>
<blockquote>
<div><p>Maximum number of iterations in optimization.</p>
</div></blockquote>
<p><strong>maxfun</strong> : int</p>
<blockquote class="last">
<div><p>Maximum number of function evaluations in maxfun.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign.resample">
<code class="descname">resample</code><span class="sig-paren">(</span><em>r=None</em>, <em>align_runs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.SpaceTimeRealign.resample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the resampled run number r as a 4d nipy-like
image. Returns all runs as a list of images if r is None.</p>
</dd></dl>

</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nipy.algorithms.registration.groupwise_registration.adjust_subsampling">
<code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">adjust_subsampling</code><span class="sig-paren">(</span><em>speedup</em>, <em>dims</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.adjust_subsampling" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="nipy.algorithms.registration.groupwise_registration.guess_slice_axis_and_direction">
<code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">guess_slice_axis_and_direction</code><span class="sig-paren">(</span><em>slice_info</em>, <em>affine</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.guess_slice_axis_and_direction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="nipy.algorithms.registration.groupwise_registration.interp_slice_times">
<code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">interp_slice_times</code><span class="sig-paren">(</span><em>Z</em>, <em>slice_times</em>, <em>tr</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.interp_slice_times" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="nipy.algorithms.registration.groupwise_registration.make_grid">
<code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">make_grid</code><span class="sig-paren">(</span><em>dims</em>, <em>subsampling=(1</em>, <em>1</em>, <em>1)</em>, <em>borders=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.make_grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="nipy.algorithms.registration.groupwise_registration.realign4d">
<code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">realign4d</code><span class="sig-paren">(</span><em>runs</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em>, <em>time_interp=True</em>, <em>align_runs=True</em>, <em>loops=5</em>, <em>between_loops=5</em>, <em>speedup=5</em>, <em>refscan=0</em>, <em>borders=(1</em>, <em>1</em>, <em>1)</em>, <em>optimizer='ncg'</em>, <em>xtol=1e-05</em>, <em>ftol=1e-05</em>, <em>gtol=1e-05</em>, <em>stepsize=1e-06</em>, <em>maxiter=64</em>, <em>maxfun=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.realign4d" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>runs</strong> : list of Image4d objects</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>transforms</strong> : list</p>
<blockquote>
<div><p>nested list of rigid transformations</p>
</div></blockquote>
<p>transforms map an &#8216;ideal&#8217; 4d grid (conventionally aligned with the</p>
<p>first scan of the first run) to the &#8216;acquisition&#8217; 4d grid for each</p>
<p class="last">run</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nipy.algorithms.registration.groupwise_registration.resample4d">
<code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">resample4d</code><span class="sig-paren">(</span><em>im4d</em>, <em>transforms</em>, <em>time_interp=True</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.resample4d" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample a 4D image according to the specified sequence of spatial
transforms, using either 4D interpolation if <cite>time_interp</cite> is True
and 3D interpolation otherwise.</p>
</dd></dl>

<dl class="function">
<dt id="nipy.algorithms.registration.groupwise_registration.scanner_coords">
<code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">scanner_coords</code><span class="sig-paren">(</span><em>xyz</em>, <em>affine</em>, <em>from_world</em>, <em>to_world</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.scanner_coords" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="nipy.algorithms.registration.groupwise_registration.single_run_realign4d">
<code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">single_run_realign4d</code><span class="sig-paren">(</span><em>im4d</em>, <em>affine_class=&lt;class 'nipy.algorithms.registration.affine.Rigid'&gt;</em>, <em>time_interp=True</em>, <em>loops=5</em>, <em>speedup=5</em>, <em>refscan=0</em>, <em>borders=(1</em>, <em>1</em>, <em>1)</em>, <em>optimizer='ncg'</em>, <em>xtol=1e-05</em>, <em>ftol=1e-05</em>, <em>gtol=1e-05</em>, <em>stepsize=1e-06</em>, <em>maxiter=64</em>, <em>maxfun=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.single_run_realign4d" title="Permalink to this definition">¶</a></dt>
<dd><p>Realign a single run in space and time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>im4d</strong> : Image4d instance</p>
<p><strong>speedup</strong> : int or sequence</p>
<blockquote class="last">
<div><p>If a sequence, implement a multi-scale realignment</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nipy.algorithms.registration.groupwise_registration.tr_from_header">
<code class="descclassname">nipy.algorithms.registration.groupwise_registration.</code><code class="descname">tr_from_header</code><span class="sig-paren">(</span><em>images</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.algorithms.registration.groupwise_registration.tr_from_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the TR from the header of an image or list of images.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>images</strong> : image or list of images</p>
<blockquote>
<div><p>Single or multiple input 4d images representing one or
several sessions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>Repetition time, as specified in NIfTI header.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>if the TR between the images is inconsistent.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nipy.algorithms.registration.histogram_registration.html" title="algorithms.registration.histogram_registration"
             >next</a> |</li>
        <li class="right" >
          <a href="nipy.algorithms.registration.chain_transform.html" title="algorithms.registration.chain_transform"
             >previous</a> |</li>
  <li><a href="../../index.html">NIPY home</a> |&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >NIPY documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >API</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2017, Neuroimaging in Python team.
      Last updated on Mar 17, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>