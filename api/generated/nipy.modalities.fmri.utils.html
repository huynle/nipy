<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Neuroimaging in Python &#8212; NIPY Documentation</title>
    
    <link rel="stylesheet" href="../../_static/nipy.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5.0.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pkg_info" href="nipy.pkg_info.html" />
    <link rel="prev" title="modalities.fmri.spm.trace" href="nipy.modalities.fmri.spm.trace.html" />
  <meta name="keywords" content="nipy, neuroimaging, python, neuroscience, time
				 series">

  </head>
  <body role="document">
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
 <a href="../../index.html">
  <img src="../../_static/reggie2.png" alt="NIPY logo"  border="0" />
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nipy.pkg_info.html" title="pkg_info"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nipy.modalities.fmri.spm.trace.html" title="modalities.fmri.spm.trace"
             accesskey="P">previous</a> |</li>
  <li><a href="../../index.html">NIPY home</a> |&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >NIPY documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U">API</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

  
<h4> Site Navigation </h4>
  <ul>
    <li><a href="../../documentation.html">Documentation</a></li>
    <li><a href="../../devel/index.html">Development</a></li>
  </ul>

<h4> NIPY Community </h4>
  <ul class="simple">
    <li><a class="reference external"
	href="http://nipy.org/">Community Home</a></li>
    <li><a class="reference external"
	href="http://nipy.org/project-directory">NIPY Projects</a></li>
    <li><a class="reference external"
	href="https://mail.python.org/mailman/listinfo/neuroimaging">Mailing List</a></li>
    <li><a class="reference external"
	href="license.html">License</a></li>
  </ul>

<h4> Github repo </h4>
  <ul class="simple">
    <li><a class="reference external"
	href="http://github.com/nipy/nipy/">Nipy Github</a></li>
  </ul>

  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">modalities.fmri.utils</a><ul>
<li><a class="reference internal" href="#module-modalities-fmri-utils">Module: <code class="docutils literal"><span class="pre">modalities.fmri.utils</span></code></a></li>
<li><a class="reference internal" href="#classes">Classes</a><ul>
<li><a class="reference internal" href="#interp1dnumeric"><code class="docutils literal"><span class="pre">Interp1dNumeric</span></code></a></li>
<li><a class="reference internal" href="#timeconvolver"><code class="docutils literal"><span class="pre">TimeConvolver</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nipy.modalities.fmri.spm.trace.html"
                        title="previous chapter">modalities.fmri.spm.trace</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nipy.pkg_info.html"
                        title="next chapter">pkg_info</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/api/generated/nipy.modalities.fmri.utils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>

<div id="searchbox-ml" style="display: none">
  <h3>Search mailing list archive</h3>
  <script type="text/javascript">
    function mlsearch(curobj)
    {
    curobj.q.value="site:http://mail.python.org/pipermail/neuroimaging/ "+curobj.userquery.value
    }
  </script>
  <form action="http://www.google.com/search" method="get" onSubmit="mlsearch(this)">
    <input name="userquery" size="13" type="text" /> <input type="submit" value="Go" />
    <input name="q" type="hidden" />
  </form>
</div>
  
<div id="searchbox-site" style="display: none">
  <h3>Search this site</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="13" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script type="text/javascript">$('#searchbox-ml').show(0);</script>
<script type="text/javascript">$('#searchbox-site').show(0);</script>


        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="modalities-fmri-utils">
<h1>modalities.fmri.utils<a class="headerlink" href="#modalities-fmri-utils" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-modalities-fmri-utils">
<h2>Module: <code class="xref py py-mod docutils literal"><span class="pre">modalities.fmri.utils</span></code><a class="headerlink" href="#module-modalities-fmri-utils" title="Permalink to this headline">¶</a></h2>
<p>Inheritance diagram for <code class="docutils literal"><span class="pre">nipy.modalities.fmri.utils</span></code>:</p>
<img src="../../_images/inheritance-c9a2b72598efb297dbb03c9f1e8aea7a1232b68a.png" alt="Inheritance diagram of nipy.modalities.fmri.utils" usemap="#inheritance24aa149a64" class="inheritance"/>
<map id="inheritance24aa149a64" name="inheritance24aa149a64">
<area shape="rect" id="node1" href="#nipy.modalities.fmri.utils.Interp1dNumeric" target="_top" title="Wrapper for interp1 to raise TypeError for object array input" alt="" coords="279,56,472,82"/>
<area shape="rect" id="node2" title="Interpolate a 1&#45;D function." alt="" coords="5,56,231,82"/>
<area shape="rect" id="node3" href="#nipy.modalities.fmri.utils.TimeConvolver" target="_top" title="Make a convolution kernel from a symbolic function of t" alt="" coords="28,5,208,32"/>
</map>
<span class="target" id="module-nipy.modalities.fmri.utils"></span><p>This module defines some convenience functions of time.

interp : an expresion for a interpolated function of time

linear_interp : an expression for a linearly interpolated function of
   time

step_function : an expression for a step function of time

events : a convenience function to generate sums of events

blocks : a convenience function to generate sums of blocks

convolve_functions : numerically convolve two functions of time

fourier_basis : a convenience function to generate a Fourier basis</p>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="interp1dnumeric">
<h3><a class="reference internal" href="#nipy.modalities.fmri.utils.Interp1dNumeric" title="nipy.modalities.fmri.utils.Interp1dNumeric"><code class="xref py py-class docutils literal"><span class="pre">Interp1dNumeric</span></code></a><a class="headerlink" href="#interp1dnumeric" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.modalities.fmri.utils.Interp1dNumeric">
<em class="property">class </em><code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">Interp1dNumeric</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>kind='linear'</em>, <em>axis=-1</em>, <em>copy=True</em>, <em>bounds_error=None</em>, <em>fill_value=nan</em>, <em>assume_sorted=False</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.Interp1dNumeric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">scipy.interpolate.interpolate.interp1d</span></code></p>
<p>Wrapper for interp1 to raise TypeError for object array input</p>
<p>We need this because sympy will try to evaluate interpolated functions when
constructing expressions involving floats.  At least sympy 1.0 only accepts
TypeError or AttributeError as indication that the implemented value cannot
be sampled with the sympy expression.  Therefore, raise a TypeError
directly for an input giving an object array (such as a sympy expression),
rather than letting interp1d raise a ValueError.</p>
<p>See:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/nipy/nipy/issues/395">https://github.com/nipy/nipy/issues/395</a></li>
<li><a class="reference external" href="https://github.com/sympy/sympy/issues/10810">https://github.com/sympy/sympy/issues/10810</a></li>
</ul>
<dl class="method">
<dt id="nipy.modalities.fmri.utils.Interp1dNumeric.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>kind='linear'</em>, <em>axis=-1</em>, <em>copy=True</em>, <em>bounds_error=None</em>, <em>fill_value=nan</em>, <em>assume_sorted=False</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.Interp1dNumeric.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a 1D linear interpolation class.</p>
</dd></dl>

<dl class="attribute">
<dt id="nipy.modalities.fmri.utils.Interp1dNumeric.dtype">
<code class="descname">dtype</code><a class="headerlink" href="#nipy.modalities.fmri.utils.Interp1dNumeric.dtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="nipy.modalities.fmri.utils.Interp1dNumeric.fill_value">
<code class="descname">fill_value</code><a class="headerlink" href="#nipy.modalities.fmri.utils.Interp1dNumeric.fill_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="timeconvolver">
<h3><a class="reference internal" href="#nipy.modalities.fmri.utils.TimeConvolver" title="nipy.modalities.fmri.utils.TimeConvolver"><code class="xref py py-class docutils literal"><span class="pre">TimeConvolver</span></code></a><a class="headerlink" href="#timeconvolver" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nipy.modalities.fmri.utils.TimeConvolver">
<em class="property">class </em><code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">TimeConvolver</code><span class="sig-paren">(</span><em>expr</em>, <em>support</em>, <em>delta</em>, <em>fill=0</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.TimeConvolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Make a convolution kernel from a symbolic function of t</p>
<p>A convolution kernel is a function with extra attributes to allow it to
function as a kernel for numerical convolution (see
<a class="reference internal" href="#nipy.modalities.fmri.utils.convolve_functions" title="nipy.modalities.fmri.utils.convolve_functions"><code class="xref py py-func docutils literal"><span class="pre">convolve_functions()</span></code></a>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>expr</strong> : sympy expression</p>
<blockquote>
<div><p>An expression that is a function of t only.</p>
</div></blockquote>
<p><strong>support</strong> : 2 sequence</p>
<blockquote>
<div><p>Sequence is <code class="docutils literal"><span class="pre">(low,</span> <span class="pre">high)</span></code> where expression is defined between <code class="docutils literal"><span class="pre">low</span></code>
and <code class="docutils literal"><span class="pre">high</span></code>, and can be assumed to be <cite>fill</cite> otherwise</p>
</div></blockquote>
<p><strong>delta</strong> : float</p>
<blockquote class="last">
<div><p>smallest change in domain of <cite>expr</cite> to use for numerical evaluation of
<cite>expr</cite></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nipy.modalities.fmri.utils.TimeConvolver.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>expr</em>, <em>support</em>, <em>delta</em>, <em>fill=0</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.TimeConvolver.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nipy.modalities.fmri.utils.TimeConvolver.convolve">
<code class="descname">convolve</code><span class="sig-paren">(</span><em>g</em>, <em>g_interval</em>, <em>name=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.TimeConvolver.convolve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Convolve sympy expression <cite>g</cite> with this kernel</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : sympy expr</p>
<blockquote>
<div><p>An expression that is a function of t only.</p>
</div></blockquote>
<p><strong>g_interval</strong> : (2,) sequence of floats</p>
<blockquote>
<div><p>Start and end of the interval of t over which to convolve g</p>
</div></blockquote>
<p><strong>name</strong> : None or str, optional</p>
<blockquote>
<div><p>Name of the convolved function in the resulting expression.
Defaults to one created by <code class="docutils literal"><span class="pre">utils.interp</span></code>.</p>
</div></blockquote>
<p><strong>**kwargs</strong> : keyword args, optional</p>
<blockquote>
<div><p>Any other arguments to pass to the <code class="docutils literal"><span class="pre">interp1d</span></code> function in creating
the numerical function for <cite>fg</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fg</strong> : sympy expr</p>
<blockquote class="last">
<div><p>An symbolic expression that is a function of t only, and that can be
lambdified to produce a function returning the convolved series from
an input array.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nipy.modalities.fmri.utils.blocks">
<code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">blocks</code><span class="sig-paren">(</span><em>intervals</em>, <em>amplitudes=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Step function based on a sequence of intervals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>intervals</strong> : (S,) sequence of (2,) sequences</p>
<blockquote>
<div><p>Sequence (S0, S1, ... S(N-1)) of sequences, where S0 (etc) are
sequences of length 2, giving &#8216;on&#8217; and &#8216;off&#8217; times of block</p>
</div></blockquote>
<p><strong>amplitudes</strong> : (S,) sequence of float, optional</p>
<blockquote>
<div><p>Optional amplitudes for each block. Defaults to 1.</p>
</div></blockquote>
<p><strong>name</strong> : None or str, optional</p>
<blockquote>
<div><p>Name of the convolved function in the resulting expression.
Defaults to one created by <code class="docutils literal"><span class="pre">utils.interp</span></code>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>b_of_t</strong> : sympy expr</p>
<blockquote class="last">
<div><p>Sympy expression b(t) where b is a sympy anonymous function of
time that implements the block step function</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_off</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">2.4</span><span class="p">,</span><span class="mf">3.4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">blocks</span><span class="p">(</span><span class="n">on_off</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lam</span> <span class="o">=</span> <span class="n">lambdify_t</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lam</span><span class="p">(</span><span class="n">tval</span><span class="p">)</span>
<span class="go">array([ 0.,  1.,  0.,  1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">blocks</span><span class="p">(</span><span class="n">on_off</span><span class="p">,</span> <span class="n">amplitudes</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lam</span> <span class="o">=</span> <span class="n">lambdify_t</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lam</span><span class="p">(</span><span class="n">tval</span><span class="p">)</span>
<span class="go">array([ 0.,  3.,  0.,  5.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="nipy.modalities.fmri.utils.convolve_functions">
<code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">convolve_functions</code><span class="sig-paren">(</span><em>f</em>, <em>g</em>, <em>f_interval</em>, <em>g_interval</em>, <em>dt</em>, <em>fill=0</em>, <em>name=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.convolve_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Expression containing numerical convolution of <cite>fn1</cite> with <cite>fn2</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>f</strong> : sympy expr</p>
<blockquote>
<div><p>An expression that is a function of t only.</p>
</div></blockquote>
<p><strong>g</strong> : sympy expr</p>
<blockquote>
<div><p>An expression that is a function of t only.</p>
</div></blockquote>
<p><strong>f_interval</strong> : (2,) sequence of float</p>
<blockquote>
<div><p>The start and end of the interval of t over which to convolve values of f</p>
</div></blockquote>
<p><strong>g_interval</strong> : (2,) sequence of floats</p>
<blockquote>
<div><p>Start and end of the interval of t over which to convolve g</p>
</div></blockquote>
<p><strong>dt</strong> : float</p>
<blockquote>
<div><p>Time step for discretization.  We use this for creating the
interpolator to form the numerical implementation</p>
</div></blockquote>
<p><strong>fill</strong> : None or float</p>
<blockquote>
<div><p>Value to return from sampling output <cite>fg</cite> function outside range.</p>
</div></blockquote>
<p><strong>name</strong> : None or str, optional</p>
<blockquote>
<div><p>Name of the convolved function in the resulting expression.
Defaults to one created by <code class="docutils literal"><span class="pre">utils.interp</span></code>.</p>
</div></blockquote>
<p><strong>**kwargs</strong> : keyword args, optional</p>
<blockquote>
<div><p>Any other arguments to pass to the <code class="docutils literal"><span class="pre">interp1d</span></code> function in creating the
numerical function for <cite>fg</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fg</strong> : sympy expr</p>
<blockquote class="last">
<div><p>An symbolic expression that is a function of t only, and that can be
lambdified to produce a function returning the convolved series from an
input array.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipy.algorithms.statistics.formula.formulae</span> <span class="k">import</span> <span class="n">Term</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is a square wave on [0,1]</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The convolution of <code class="docutils literal"><span class="pre">f1</span></code> with itself is a triangular wave on [0, 2],
peaking at 1 with height 1</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tri</span> <span class="o">=</span> <span class="n">convolve_functions</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">1.0e-3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;conv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The result is a symbolic function</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span>
<span class="go">conv(t)</span>
</pre></div>
</div>
<p>Get the numerical values for a time vector</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ftri</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tri</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">ftri</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>The peak is at 1
&gt;&gt;&gt; x[np.argmax(y)]
1.0</p>
</dd></dl>

<dl class="function">
<dt id="nipy.modalities.fmri.utils.define">
<code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">define</code><span class="sig-paren">(</span><em>name</em>, <em>expr</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.define" title="Permalink to this definition">¶</a></dt>
<dd><p>Create function of t expression from arbitrary expression <cite>expr</cite></p>
<p>Take an arbitrarily complicated expression <cite>expr</cite> of &#8216;t&#8217; and make it
an expression that is a simple function of t, of form <code class="docutils literal"><span class="pre">'%s(t)'</span> <span class="pre">%</span>
<span class="pre">name</span></code> such that when it evaluates (via <code class="docutils literal"><span class="pre">lambdify</span></code>) it has the
right values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>expr</strong> : sympy expression</p>
<blockquote>
<div><p>with only &#8216;t&#8217; as a Symbol</p>
</div></blockquote>
<p><strong>name</strong> : str</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">nexpr: sympy expression</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>  
<span class="go">3*t + t**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newexpr</span> <span class="o">=</span> <span class="n">define</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">newexpr</span><span class="p">)</span>
<span class="go">f(t)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">lambdify_t</span><span class="p">(</span><span class="n">newexpr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">28</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">4</span><span class="o">**</span><span class="mi">2</span>
<span class="go">28</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="nipy.modalities.fmri.utils.events">
<code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">events</code><span class="sig-paren">(</span><em>times</em>, <em>amplitudes=None</em>, <em>f=DiracDelta</em>, <em>g=a</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.events" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sum of functions based on a sequence of times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>times</strong> : sequence</p>
<blockquote>
<div><p>vector of onsets length <span class="math">\(N\)</span></p>
</div></blockquote>
<p><strong>amplitudes</strong> : None or sequence length <span class="math">\(N\)</span>, optional</p>
<blockquote>
<div><p>Optional sequence of amplitudes. None (default) results in
sequence length <span class="math">\(N\)</span> of 1s</p>
</div></blockquote>
<p><strong>f</strong> : sympy.Function, optional</p>
<blockquote>
<div><p>Optional function. Defaults to DiracDelta, can be replaced with
another function, f, in which case the result is the convolution
with f.</p>
</div></blockquote>
<p><strong>g</strong> : sympy.Basic, optional</p>
<blockquote>
<div><p>Optional sympy expression function of amplitudes.  The
amplitudes, should be represented by the symbol &#8216;a&#8217;, which will
be substituted, by the corresponding value in <cite>amplitudes</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>sum_expression</strong> : Sympy.Add</p>
<blockquote class="last">
<div><p>Sympy expression of time <span class="math">\(t\)</span>, where onsets, as a function of <span class="math">\(t\)</span>,
have been symbolically convolved with function <cite>f</cite>, and any
function <cite>g</cite> of corresponding amplitudes.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>We import some sympy stuff so we can test if we&#8217;ve got what we
expected</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">DiracDelta</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipy.modalities.fmri.utils</span> <span class="k">import</span> <span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span> <span class="o">=</span> <span class="n">events</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span> <span class="o">==</span> <span class="n">DiracDelta</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span> <span class="o">+</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">DiracDelta</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">DiracDelta</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">+</span> <span class="n">T</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hrf</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;hrf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span> <span class="o">=</span> <span class="n">events</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="n">f</span><span class="o">=</span><span class="n">hrf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span> <span class="o">==</span> <span class="n">hrf</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span> <span class="o">+</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">hrf</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">hrf</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">+</span> <span class="n">T</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span> <span class="o">=</span> <span class="n">events</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="n">amplitudes</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs</span> <span class="o">==</span> <span class="o">-</span><span class="n">DiracDelta</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span> <span class="o">+</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">DiracDelta</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">+</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">DiracDelta</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span> <span class="o">+</span> <span class="n">T</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="nipy.modalities.fmri.utils.fourier_basis">
<code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">fourier_basis</code><span class="sig-paren">(</span><em>freq</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.fourier_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>sin and cos Formula for Fourier drift</p>
<p>The Fourier basis consists of sine and cosine waves of given
frequencies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>freq</strong> : sequence of float</p>
<blockquote>
<div><p>Frequencies for the terms in the Fourier basis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>f</strong> : Formula</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">=</span><span class="n">fourier_basis</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">terms</span>
<span class="go">array([cos(2*pi*t), sin(2*pi*t), cos(4*pi*t), sin(4*pi*t), cos(6*pi*t),</span>
<span class="go">       sin(6*pi*t)], dtype=object)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">mean</span>
<span class="go">_b0*cos(2*pi*t) + _b1*sin(2*pi*t) + _b2*cos(4*pi*t) + _b3*sin(4*pi*t) + _b4*cos(6*pi*t) + _b5*sin(6*pi*t)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="nipy.modalities.fmri.utils.interp">
<code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">interp</code><span class="sig-paren">(</span><em>times</em>, <em>values</em>, <em>fill=0</em>, <em>name=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic interpolation function of t given <cite>times</cite> and <cite>values</cite></p>
<p>Imterpolator such that:</p>
<p>f(times[i]) = values[i]</p>
<dl class="docutils">
<dt>if t &lt; times[0] or t &gt; times[-1]:</dt>
<dd>f(t) = fill</dd>
</dl>
<p>See <code class="docutils literal"><span class="pre">scipy.interpolate.interp1d</span></code> for details of interpolation
types and other keyword arguments.  Default is &#8216;kind&#8217; is linear,
making this function, by default, have the same behavior as
<code class="docutils literal"><span class="pre">linear_interp</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>times</strong> : array-like</p>
<blockquote>
<div><p>Increasing sequence of times</p>
</div></blockquote>
<p><strong>values</strong> : array-like</p>
<blockquote>
<div><p>Values at the specified times</p>
</div></blockquote>
<p><strong>fill</strong> : None or float, optional</p>
<blockquote>
<div><p>Value on the interval (-np.inf, times[0]). Default 0. If None, raises
error outside bounds</p>
</div></blockquote>
<p><strong>name</strong> : None or str, optional</p>
<blockquote>
<div><p>Name of symbolic expression to use. If None, a default is used.</p>
</div></blockquote>
<p><strong>**kw</strong> : keyword args, optional</p>
<blockquote>
<div><p>passed to <code class="docutils literal"><span class="pre">interp1d</span></code></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>f</strong> : sympy expression</p>
<blockquote class="last">
<div><p>A Function of t.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">interp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">5.</span><span class="p">],[</span><span class="mf">2.</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">3.9</span><span class="p">,</span><span class="mf">4.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">lambdify_t</span><span class="p">(</span><span class="n">s</span><span class="p">)(</span><span class="n">tval</span><span class="p">)</span>
</pre></div>
</div>
<p>0 outside bounds by default</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">3.95</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="nipy.modalities.fmri.utils.lambdify_t">
<code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">lambdify_t</code><span class="sig-paren">(</span><em>expr</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.lambdify_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Return sympy function of t <cite>expr</cite> lambdified as function of t</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>expr</strong> : sympy expr</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>func</strong> : callable</p>
<blockquote class="last">
<div><p>Numerical implementation of function</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nipy.modalities.fmri.utils.linear_interp">
<code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">linear_interp</code><span class="sig-paren">(</span><em>times</em>, <em>values</em>, <em>fill=0</em>, <em>name=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.linear_interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear interpolation function of t given <cite>times</cite> and <cite>values</cite></p>
<p>Imterpolator such that:</p>
<p>f(times[i]) = values[i]</p>
<dl class="docutils">
<dt>if t &lt; times[0] or t &gt; times[-1]:</dt>
<dd>f(t) = fill</dd>
</dl>
<p>This version of the function enforces the &#8216;linear&#8217; kind of interpolation
(argument to <code class="docutils literal"><span class="pre">scipy.interpolate.interp1d</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>times</strong> : array-like</p>
<blockquote>
<div><p>Increasing sequence of times</p>
</div></blockquote>
<p><strong>values</strong> : array-like</p>
<blockquote>
<div><p>Values at the specified times</p>
</div></blockquote>
<p><strong>fill</strong> : None or float, optional</p>
<blockquote>
<div><p>Value on the interval (-np.inf, times[0]). Default 0. If None, raises
error outside bounds</p>
</div></blockquote>
<p><strong>name</strong> : None or str, optional</p>
<blockquote>
<div><p>Name of symbolic expression to use. If None, a default is used.</p>
</div></blockquote>
<p><strong>**kw</strong> : keyword args, optional</p>
<blockquote>
<div><p>passed to <code class="docutils literal"><span class="pre">interp1d</span></code></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>f</strong> : sympy expression</p>
<blockquote class="last">
<div><p>A Function of t.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">linear_interp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">5.</span><span class="p">],[</span><span class="mf">2.</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">3.9</span><span class="p">,</span><span class="mf">4.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">lambdify_t</span><span class="p">(</span><span class="n">s</span><span class="p">)(</span><span class="n">tval</span><span class="p">)</span>
</pre></div>
</div>
<p>0 outside bounds by default</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">3.95</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="nipy.modalities.fmri.utils.step_function">
<code class="descclassname">nipy.modalities.fmri.utils.</code><code class="descname">step_function</code><span class="sig-paren">(</span><em>times</em>, <em>values</em>, <em>name=None</em>, <em>fill=0</em><span class="sig-paren">)</span><a class="headerlink" href="#nipy.modalities.fmri.utils.step_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Right-continuous step function of time t</p>
<p>Function of t such that</p>
<p>f(times[i]) = values[i]</p>
<dl class="docutils">
<dt>if t &lt; times[0]:</dt>
<dd>f(t) = fill</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>times</strong> : (N,) sequence</p>
<blockquote>
<div><p>Increasing sequence of times</p>
</div></blockquote>
<p><strong>values</strong> : (N,) sequence</p>
<blockquote>
<div><p>Values at the specified times</p>
</div></blockquote>
<p><strong>fill</strong> : float</p>
<blockquote>
<div><p>Value on the interval (-np.inf, times[0])</p>
</div></blockquote>
<p><strong>name</strong> : str</p>
<blockquote>
<div><p>Name of symbolic expression to use. If None, a default is used.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>f_t</strong> : sympy expr</p>
<blockquote class="last">
<div><p>Sympy expression f(t) where f is a sympy implemented anonymous
function of time that implements the step function.  To get the
numerical version of the function, use <code class="docutils literal"><span class="pre">lambdify_t(f_t)</span></code></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">step_function</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">3.9</span><span class="p">,</span><span class="mf">4.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lam</span> <span class="o">=</span> <span class="n">lambdify_t</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lam</span><span class="p">(</span><span class="n">tval</span><span class="p">)</span>
<span class="go">array([ 0.,  2.,  4.,  6.])</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nipy.pkg_info.html" title="pkg_info"
             >next</a> |</li>
        <li class="right" >
          <a href="nipy.modalities.fmri.spm.trace.html" title="modalities.fmri.spm.trace"
             >previous</a> |</li>
  <li><a href="../../index.html">NIPY home</a> |&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >NIPY documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >API</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2017, Neuroimaging in Python team.
      Last updated on Mar 17, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>